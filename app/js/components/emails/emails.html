<div class="row emails">
  <div class="large-14 medium-16 small-18 large-centered medium-centered columns">
    <div class="row heading">
      <h1>{{'EMAILS' | translate}}</h1>
    </div>

    <!--{{'INVITE_FAILED_REASON' | translate}}-->

    <h2>Problematic emails ({{vm.fails.length}})</h2>

    <div class="row">
      <table class="logs">
        <thead>
          <tr>
            <td>Date / time</td>
            <td>User</td>
            <td>Email type</td>
            <td>Email status</td>
            <td>Action to take</td>
          </tr>
        </thead>
        <tbody>
          <tr ng-repeat="entry in vm.fails">
            <td>{{entry.date | date : 'dd'}} {{entry.date | date : 'MMMM' | uppercase | translate}} {{entry.date | date : 'yyyy'}} {{entry.date | date : 'HH'}}:{{entry.date | date : 'mm'}}</td>
            <td>
              <em><a ui-sref="users({id:entry.User.Id})">{{entry.User.FirstName}} {{entry.User.LastName}}</a></em><br>
              <span ng-hide="entry.editing">{{entry.To}}<br></span>
              <ng-form name="emailForm" ng-show="entry.editing" ng-submit="vm.saveEmailAndResend(entry)" novalidate>
                <input name="email" type="email" ng-model="entry.To" required autofocus>
              </ng-form>
              {{'USER_STATUS' | translate}}: {{entry.User.State | translate}}
            </td>
            <td>{{entry.Communication.Name | translate}}</td>
            <td><span class="warning">{{entry.reason | translate}}</span></td>
            <td>
              <button class="secondary" ng-disabled="entry.sending" ng-if="entry.actionButton === 'edit'" ng-click="vm.editEmail(entry)">
                <span ng-show="emailForm.$pristine">{{'EMAIL_EDIT' | translate}}</span>
                <span ng-hide="emailForm.$pristine">Save change and resend invite</span>
              </button>
              <button class="secondary" ng-disabled="entry.sending" ng-if="entry.actionButton === 'resend'" ng-click="vm.sendInvite(entry)">{{'EMAIL_RESEND' | translate}}</button>
              <alert ng-if="entry.Alert" type="entry.Alert.type">{{entry.Alert.msg | translate}}</alert>
            </td>
          </tr>
        </tbody>
      </table>

    <h2>Successful emails ({{vm.logs.length}})</h2>

    <table>
        <thead>
          <tr>
            <td>User</td>
            <td>Email Type</td>
            <td>CreateDate</td>
            <td>SpamReport</td>
            <td>Bounce</td>
            <td>Bounce Reason</td>
            <td>Dropped</td>
          </tr>
        </thead>
        <tbody>
          <tr ng-repeat="entry in vm.logs">
            <td>{{entry.To}}</td>
            <td>{{entry.Communication.Name}}</td>
            <td>{{entry.CreateDate}}</td>
            <td><a ui-sref="users({id:entry.User.Id})">{{entry.User.FirstName}} {{entry.User.LastName}}</a></td>
            <td>{{entry.User.LastLoggedInDate}}</td>
            <td>{{entry.DateClicked}}</td>
            <td>{{entry.DateDelivered}}</td>
            <td>{{entry.DateOpen}}</td>
            <td>{{entry.DateProcessed}}</td>
            <td>{{entry.DateSpamReport}}</td>
            <td>{{entry.DateBounce}}</td>
            <td>{{entry.BounceReason}}</td>
            <td>{{entry.DateDropped}}</td>
          </tr>
        </tbody>
      </table>
    </div>
  </div>
</div>
